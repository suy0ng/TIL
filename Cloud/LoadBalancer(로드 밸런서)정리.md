# Load Balancer(로드 밸런서)
![img](https://nesoy.github.io/assets/posts/20180602/3.png)
<br/>
<b>서버에 가해지는 부하(=로드)를 분산(=밸런싱)해주는 장치 또는 기술을 통칭</b>합니다. 클라이언트와 서버풀(Server Pool, 분산 네트워크를 구성하는 서버들의 그룹)사이에 위치하며, 한 대의 서버로 부하가 집중되지 않게 해준다.
<br/><br/>
## 로드밸런싱은 항상 필요할까? <br/>
로드 밸런싱은 여러 대의 서버를 두고 서비스를 젱공하는 분산 처리 시스템에서 필요한 기술이므로, 서비스 제공 초기 단계라면 적은 수의 클라이언트로 인해 서버 한 대로 요청에 응답하는것이 가능하다. 하지만 서비스 규모가 커지고, 이용자 수가 늘어나면,,,
<br/><br/>
## 트래픽이 커지면? 대처할수 있는 방법 Scale-up, Scale-down<br/>
<b>Scale-up</b>의 경우 서버 자체의 성능을 확장하는 것을 의미한다.  ( 예시 CPU i3 → i7 )반면 <b>Scale-out</b> 같은 경우는 기존 서버와 동일하거나 낮은 서버를 증설하여 운영하는 것을 의미한다. Scale-out방식으로 서버를 증설하게 되면 이때 로드밸런싱이 반드시 필요하다.
<br/><br/>

# 로드밸런싱 기법
* <b>라운드로빈 방식(Round Robin Method)</b> : 
서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식이다. 클라이언트의 요청을 순서대로 분배하기 떄문에 여러 대의 서버가 동일한 스펙을 갖고 이쏙, 서버와의 연결이 오래 지속되지 않는 경우에 적합<br/><br/>
* <b>가중 라운드로빈 방식(Weighted Round Robin Method)</b> : 각각의 서버마다 가중치를 매기고 가중치가 높은 서버에 우선적으로 배분합니다. 주로 서버의 트래픽 처리 능력이 상이한 경우 사용되는 부하 분산 방식이다.<br/><br/>
* <b>IP 해시 방식(IP Hash Method)</b> : 클라이언트 IP주소를 특정서버로 매핑하여 요청을 처리하는 방식. 사용자의 IP를 해싱(Hashing , 임의의 길이를 지닌데이터를 고정된길이의 데이터로매핑하는것)해 로드를 분배하기 때문에 사용자가 항상 동일한서버로 연결되는 것을 보장함<br/><br/>
* <b>최소 연결 방식(Least Connection Method)</b> :  요청이 들어온 시점에 가장 적은 연결상태를 보이는 서버엣 우선적으로 트래픽 배분한다. 세션이 자주 길어지거나, 서버에 분배된 트래픽들이 일정하지 않은 경우 적합한 방식.<br/><br/>
* <b>최소 리스폰타임(Least Response Time Method)</b> :   서버의 현재 연결 상태와 응답시간을 모두 고려하여 트래픽을 배분합니다. 가장 적은 연결 상태와 가장 짧은 응답시간을 보이는 서버에 우선적을 로드를 배분하는 방식<br/><br/>

# L4 로드 밸런싱과 L7 로드 밸런싱
로드 밸런싱에는 L4 로드 밸런싱과 L7 로드 밸런싱이 가장 많이 활용된다. 그 이유는 L4  로드밸런스부터 포트(Port)정보를 바탕으로 로드를 분산하는것이 가능하기 때문이다.

**L4 Load Balance**r는 ***IP, Port*** 를 기준으로 스케줄링 알고리즘을 통해 부하를 분산합니다. 클라이언트에서 로드밸런서(DNS)로 요청을 보냈을 때 최적의 서버로 요청을 전송하고 결과를 클라이언트에게 줍니다. 즉, 요청하는 서비스의 종류와 상관 없이 공장을 여러 개 돌리는 것입니다

**L7 Load Balancer**는 L7 위에서 동작하기 때문에 IP, Port 이외에도 ***URI, Payload, Http Header, Cookie*** 등의 내용을 기준으로 부하를 분산합니다. 그래서 콘텐츠 기반 스위칭이라고도 합니다.

L4 Load Balancer는 단지 부하를 분산시키는 것이라면, L7 Load Balancer는 요청의 세부적인 사항 두고 결제만 담당하는 서버, 회원가입만을 담당하는 서버 등으로 분리해서 가볍고 작은 단위로 여러개의 서비스를 운영하고 요청을 각각의 서버에 분산할 수 있는 것입니다.

